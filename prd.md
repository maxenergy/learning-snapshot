# 学习快照浏览器插件 - 产品需求文档 (PRD)

**版本**: v1.0  
**日期**: 2025-10-04  
**作者**: Product Team  
**状态**: Draft

---

## 1. 产品概述

### 1.1 产品定位
一款面向学习者和知识工作者的智能浏览器插件，通过快照捕获、AI翻译、知识增强和自动化笔记管理，帮助用户高效完成网页内容的学习、整理和归档。

### 1.2 目标用户
- 外语学习者（需要双语对照阅读）
- 研究人员（需要文献整理和知识管理）
- 知识工作者（需要高效信息收集）
- Obsidian用户（需要笔记系统集成）

### 1.3 核心价值
- **一键捕获**: 快速保存网页内容为本地快照
- **智能翻译**: 双语对照、划词翻译，降低阅读门槛
- **AI增强**: 自动解释术语、关联知识点
- **自动归档**: 智能分类、时间归档、多维检索
- **无缝集成**: 与Obsidian笔记系统深度整合

---

## 2. 功能需求

### 2.1 快照捕获功能

#### 2.1.1 快照触发
- **触发方式**:
  - 浏览器工具栏快照按钮
  - 快捷键（默认: Ctrl+Shift+S / Cmd+Shift+S）
  - 右键菜单"创建学习快照"
  
- **捕获范围选项**:
  - [ ] 整页快照（完整网页内容）
  - [ ] 主体内容快照（自动提取正文）
  - [ ] 选区快照（用户选择的部分）
  - [ ] 视窗快照（当前可见区域）

#### 2.1.2 内容提取
- **核心内容识别**:
  - 使用Readability算法提取正文
  - 自动识别标题、段落、代码块
  - 保留原始HTML结构
  
- **资源处理**:
  - 图片本地化存储（Base64或文件形式）
  - CSS样式内联保存
  - 代码块语法高亮保持
  
- **元数据采集**:
  - 页面标题、URL、作者、发布日期
  - 网站图标（favicon）
  - 捕获时间戳

#### 2.1.3 快照存储
- 存储格式: JSON + HTML
- 存储位置: IndexedDB（本地）
- 快照命名规则: `{timestamp}_{title_slug}.json`

---

### 2.2 翻译功能

#### 2.2.1 双语对照翻译
- **翻译模式**:
  - [ ] 段落级对照（原文与译文上下排列）
  - [ ] 句子级对照（原文与译文交替显示）
  - [ ] 悬浮对照（鼠标悬停显示译文）
  
- **交互设计**:
  - 点击段落切换原文/译文显示
  - 原文与译文可视化区分（颜色/字体）
  - 支持译文编辑和保存

#### 2.2.2 划词翻译
- **触发机制**:
  - 选中文本后显示翻译浮窗
  - 浮窗内容: 译文 + 发音 + 词性
  - 可固定浮窗进行深度查看
  
- **增强功能**:
  - 添加到生词本
  - 生成单词卡片
  - 查看例句

#### 2.2.3 翻译引擎配置
- **支持的翻译服务**:
  - DeepL API
  - Google Translate API
  - OpenAI GPT（翻译模式）
  - Claude API（翻译模式）
  - Ollama本地模型（离线翻译）
  
- **配置项**:
  - API密钥管理
  - 目标语言选择（默认: 中文）
  - 翻译质量（快速/标准/高质量）
  - 本地模型地址（Ollama）

---

### 2.3 AI知识增强

#### 2.3.1 术语解释
- **自动识别**:
  - 专业术语高亮标记
  - 技术名词自动检测
  
- **AI解释**:
  - 点击术语获取AI解释
  - 解释内容包括: 定义、背景、应用场景
  - 支持多级深度解释

#### 2.3.2 知识关联
- **关联搜索**:
  - 基于当前内容推荐相关知识点
  - 展示关联文章/概念链接
  - 生成知识图谱预览
  
- **概念卡片**:
  - 自动生成关键概念卡片
  - 包含: 概念名称、定义、示例、相关链接

#### 2.3.3 AI服务配置
- **支持的AI服务**:
  - OpenAI GPT-4/GPT-3.5
  - Anthropic Claude
  - Google Gemini
  - Ollama本地模型（llama3, mistral等）
  
- **配置选项**:
  - API密钥管理
  - 模型选择
  - 温度参数调整
  - 本地模型服务地址

---

### 2.4 笔记生成与批注

#### 2.4.1 自动笔记生成
- **生成内容**:
  - [ ] 智能摘要（AI生成）
  - [ ] 关键要点提取（bullet points）
  - [ ] 思维导图大纲
  - [ ] 问答对（Q&A）
  
- **模板选择**:
  - 学术论文模板
  - 技术文档模板
  - 新闻资讯模板
  - 自定义模板

#### 2.4.2 手动批注
- **批注工具**:
  - 高亮标记（多种颜色）
  - 文字笔记（段落级别）
  - 标签添加
  - 重要度评级（1-5星）
  
- **批注管理**:
  - 批注列表面板
  - 批注导出
  - 批注搜索

#### 2.4.3 笔记编辑器
- **编辑功能**:
  - Markdown格式支持
  - 所见即所得编辑
  - 代码块语法高亮
  - 图片拖拽插入
  
- **实时预览**:
  - 编辑与预览分屏
  - 笔记自动保存

---

### 2.5 归档与检索

#### 2.5.1 自动归档
- **分类方式**:
  - [ ] AI自动分类（基于内容语义）
  - [ ] 按网站域名分类
  - [ ] 按标签分类
  - [ ] 按时间归档（日/周/月/年）
  
- **分类规则**:
  - 预设分类: 技术、学术、新闻、博客等
  - 自定义分类标签
  - 多分类支持

#### 2.5.2 检索功能
- **检索方式**:
  - [ ] 全文检索（标题+内容）
  - [ ] 标签筛选
  - [ ] 时间范围筛选
  - [ ] 网站来源筛选
  - [ ] 评级筛选
  
- **高级检索**:
  - 组合条件查询
  - 正则表达式搜索
  - 语义搜索（AI向量检索）

#### 2.5.3 快照管理
- **批量操作**:
  - 批量导出
  - 批量删除
  - 批量修改分类
  
- **数据统计**:
  - 快照数量统计
  - 存储空间占用
  - 分类分布图表

---

### 2.6 Obsidian集成

#### 2.6.1 导出格式
- **Markdown导出**:
  - 符合Obsidian规范的Markdown
  - 支持双链语法 `[[链接]]`
  - Front Matter元数据
  
- **Front Matter字段**:
  ```yaml
  ---
  title: 文章标题
  url: 原始URL
  author: 作者
  date: 捕获日期
  tags: [标签1, 标签2]
  category: 分类
  rating: 评级
  ---
  ```

#### 2.6.2 导出选项
- **导出方式**:
  - [ ] 单个快照导出
  - [ ] 批量导出（按分类/时间）
  - [ ] 自动同步到Obsidian vault
  
- **文件结构**:
  - 按分类创建文件夹
  - 附件（图片）存放位置
  - 索引文件生成

#### 2.6.3 双链支持
- **自动生成双链**:
  - 术语自动转为双链
  - 相关笔记自动关联
  - MOC（Map of Content）生成

---

## 3. 非功能需求

### 3.1 性能要求
- 快照捕获响应时间: < 2秒
- 翻译响应时间: < 3秒（段落级）
- AI解释响应时间: < 5秒
- 本地存储查询: < 500ms
- 内存占用: < 200MB（正常使用）

### 3.2 兼容性
- **浏览器支持**:
  - Chrome 90+
  - Edge 90+
  - Manifest V3规范
  
- **操作系统**:
  - Windows 10/11
  - macOS 11+
  - Linux（主流发行版）

### 3.3 安全性
- API密钥本地加密存储
- 不上传用户快照内容到第三方服务器
- 敏感数据脱敏处理
- 符合GDPR数据保护要求

### 3.4 可用性
- 界面语言: 中文、英文
- 响应式设计（适配不同屏幕）
- 键盘快捷键支持
- 无障碍访问（ARIA标签）

---

## 4. 用户场景

### 场景1: 外语学习者阅读英文技术博客
1. 访问英文技术博客文章
2. 点击快照按钮保存文章
3. 自动触发双语翻译（段落对照）
4. 划词翻译不认识的术语
5. AI解释复杂技术概念
6. 完成阅读后生成学习笔记
7. 自动归档到"技术/前端开发"分类
8. 导出到Obsidian进行二次整理

### 场景2: 研究人员整理学术文献
1. 浏览学术论文（arXiv/Google Scholar）
2. 创建快照并添加标签"机器学习"
3. 高亮关键段落和数据
4. 添加批注和个人理解
5. AI生成论文摘要和要点
6. 按研究主题归档
7. 批量导出相关论文到Obsidian
8. 通过检索功能查找特定论文

### 场景3: 知识工作者收集行业资讯
1. 浏览行业新闻网站
2. 选择关键段落创建快照
3. AI提取关键信息和趋势
4. 添加个人评论和标签
5. 按时间线归档（2025-10）
6. 定期回顾和整理
7. 生成月度行业动态报告

---

## 5. 优先级定义

### P0 - 核心功能（MVP）
- ✅ 基础快照捕获（整页/主体内容）
- ✅ 双语对照翻译（段落级）
- ✅ 本地存储与基础检索
- ✅ Markdown导出

### P1 - 重要功能
- ⭐ 划词翻译
- ⭐ AI术语解释
- ⭐ 自动笔记生成
- ⭐ 自动分类归档
- ⭐ Obsidian集成（Front Matter）

### P2 - 增强功能
- 📌 知识图谱关联
- 📌 批注管理
- 📌 高级检索（语义搜索）
- 📌 数据统计面板
- 📌 云同步（后期）

---

## 6. 技术约束

### 6.1 第三方服务依赖
- 翻译API: DeepL/Google/OpenAI/Claude
- AI服务: OpenAI/Claude/Gemini
- 本地AI: Ollama（可选）

### 6.2 数据存储限制
- IndexedDB容量: 建议单个快照 < 10MB
- 总存储建议: < 500MB（浏览器限制）

### 6.3 API调用限制
- 需遵守各API服务的速率限制
- 实现请求队列和重试机制
- 提供本地Ollama作为备选方案

---

## 7. 成功指标

### 7.1 核心指标
- 用户留存率（7日/30日）
- 快照创建数量（日均）
- 笔记导出数量

### 7.2 体验指标
- 快照捕获成功率 > 95%
- 翻译准确度评分 > 4.0/5.0
- 用户满意度 > 4.5/5.0

### 7.3 技术指标
- 插件崩溃率 < 0.1%
- API调用成功率 > 99%
- 平均响应时间 < 3秒

---

## 8. 未来规划

### 第一阶段（v1.0 - MVP）
- 核心快照功能
- 基础翻译与AI
- 本地存储与检索
- Obsidian导出

### 第二阶段（v2.0）
- 云同步功能
- 团队协作
- 移动端支持
- 高级知识图谱

### 第三阶段（v3.0）
- AI Agent自动学习
- 跨平台笔记同步
- 浏览器历史分析
- 个性化推荐系统

---

## 附录

### A. 术语表
- **快照**: 网页内容的本地化存储副本
- **双语对照**: 原文与译文并列显示的翻译模式
- **Front Matter**: Markdown文件头部的元数据块
- **Obsidian**: 流行的本地Markdown笔记软件
- **Ollama**: 本地运行大语言模型的工具

### B. 参考资料
- Readability.js: https://github.com/mozilla/readability
- Obsidian规范: https://help.obsidian.md/
- Chrome Extension Docs: https://developer.chrome.com/docs/extensions/
- Manifest V3: https://developer.chrome.com/docs/extensions/mv3/

---

**文档变更记录**

| 版本 | 日期 | 作者 | 变更说明 |
|------|------|------|----------|
| v1.0 | 2025-10-04 | Product Team | 初始版本 |
